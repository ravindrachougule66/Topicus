Program ISN,Program #,Task,Name,SQL
8,,"","SUB-Legen Werkbestand","delete from WERKBESTAND w where w.wk_terminal =~1 :2"
381,,".1.1","SQL Alle rel/prod/prodvolgnrs","insert into :1 w(w.wk_terminal, w.wk_soort, w.wk_categorie_1, w.wk_categorie_2, w.wk_categorie_3, w.wk_waarde_1, w.wk_waarde_2, w.wk_waarde_3)(select distinct :2, 'GBCP' , to_char(p.ppr_relatienummer,'999999999'), to_char(p.ppr_productnummer,'9999'), to_char(p.ppr_volgnr_per_product,'9999'), p.ppr_relatienummer, p.ppr_productnummer, p.ppr_volgnr_per_product from   :3 p, :4 c, :5 g where  p.ppr_relatienummer   = c.cl_nummer and    p.ppr_productnummer   between ~6 and ~7 and    c.cl_nummer           between ~8 and ~9 and    c.cl_relatie_type     = 1 and    c.cl_adviseur         between ~10 and ~11 and    c.cl_afdelingadviseur between ~12 and  ~13 and    g.cgv_adviseur (+)    =  ~14 and    g.cgv_clientgroep (+) = c.cl_clientgroep and    (~15 <> 3  or  g.cgv_clientgroep is not null))"
603980322,,"","SetIndirectCostData","select q2.be_id,       q2.icf_date_since,       q2.icf_date_till,       q3.icf_cfcu_id,       q3.icf_ex_ante_ex_post_ind,       q3.icf_amount,       q3.icf_percentage,       q3.icf_date_next       /*         Ik wil alle relevante data  q2##### dus selecteer ik         rsd: als je alle kolommen zou selecteren, vind je alle rijen voor dit instrument aan gezien we alleen         in de dataovergangen geïnteresseerd zijn selecteren we alleen het betreffende instrumentId en de datum vanaf / Tm                  */   from (select rsd.be_id, rsd.icf_date_since, rsd.icf_date_till          from (select ic.icf_be_id be_id,                       ic.icf_cfcu_id type_id,                       ic.icf_date_since,                       (select nvl(min(i4.icf_date_since),                                   to_date('30000101', 'YYYYMMDD')) - 1                                  from indirect_costs_per_fund_vw i4                                 where i4.icf_be_id = ic.icf_be_id                                   and i4.icf_date_since > ic.icf_date_since) icf_date_till                                  from indirect_costs_per_fund_vw ic where ic.icf_be_id in( :1  ) and ic.icf_cfcu_id in (51,52,59,62) ) rsd        /*          Group by zorgt er voor dat ik per instrument per datum vanaf / tm één rij krijg.        */         GROUP BY rsd.be_id, rsd.icf_date_since, rsd.icf_date_till         /*order by rsd.icf_date_since*/) q2        /*        In deze Q3 query verzamelen we alle indirecte kosten inclusief per rij de datum van de next en de datum van de prev        */     , (select ic.icf_id, ic.icf_be_id, ic.icf_cfcu_id, ic.icf_date_since       ,nvl(lead  (ic.icf_date_since) over ( partition by ic.icf_be_id, ic.icf_cfcu_id order by ic.icf_be_id, ic.icf_cfcu_id, ic.icf_date_since)-1,to_date('29991231','YYYYMMDD')) as icf_date_next              , ic.icf_date_till       , ic.icf_amount       , ic.icf_currency       , ic.icf_percentage       , ic.icf_ex_ante_ex_post_indfrom indirect_costs_per_fund_vw icwhere ic.icf_cfcu_id in (51,52,59,62)) q3     /* Beide samen joinen we op het instrument_id (aangezien dat in de rds-query variabel wordt mee gegegeven beperkt op instrument niveau tot één instrument        We willen alle indirecte kosten (elk type zien) die van toepassing zijn in de periodes van iedere datum overgang*/where q3.icf_be_id = q2.be_id   and q3.icf_date_next >= q2.icf_date_till   and q3.icf_date_since <= q2.icf_date_sinceorder by 1, 2, 4"
603980370,,".1.2.1.1","Count #Posities(SQL)","select count(*) from :1 p, :2 r, :3 rppwhere :4_relatienr =~5 and :4_relatienr = r.re_nummerand :4_rekeningnr = r.re_rekening  and rpp.rpp_productnummer = ~6and rpp.rpp_volgnr_per_product = ~7and rpp.rpp_relatienummer = :4_relatienrand rpp.rpp_rekening_nummer = :4_rekeningnrand :4_:8 between ~9 and ~10"
603980385,,".2","Schrijf rapport","select :1, sum(q.qrd_value_asset + q.qrd_opgelopen_rente_clv) from qrap_data qwhere q.qrd_opdracht_id=~2group by :1 order by :1"
603980389,,".2.2","Schonen","DELETE FROM :1 b WHERE b.rbat_sbat_id=~2  :3"
603980374,,".3","createBatchRange","select distinct(rpp.rpp_relatienummer)  from :1 rpp  join :2 r     on rpp.rpp_relatienummer = r.re_nummer   and rpp.rpp_rekening_nummer = r.re_rekening   and rpp.rpp_rekeningsoort = r.re_soort   and rpp.rpp_valuta = r.re_muntsoort  join :3 c    on c.cl_nummer = rpp.rpp_relatienummer  join :4 sco    on sco.spc_product = rpp.rpp_productnummer   and sco.spc_productvolgnummer = rpp.rpp_volgnr_per_product   and sco.spc_relatie = rpp.rpp_relatienummer   and sco.spc_aanmaken = 1   :5 where rpp.rpp_relatienummer between ~6 and ~7   and rpp.rpp_productnummer between ~8 and ~9   and rpp.rpp_rekeningsoort between 100 and 999   and sco.spc_form_soort = 62   and c.cl_relatie_categorie between ~10 and ~11   and c.cl_adviseur between ~12 and ~13   and c.cl_clientgroep between ~14 and ~15   and r.re_openingsdatum <> '00000000' and r.re_openingsdatum <= ~16   and (r.re_rekening_status = 2       or  r.re_rekening_status > 2 and r.re_statusdatum >= ~17      or r.re_rekening_status > 2 and r.re_statusdatum >= ~18   and ~19 = '1001')    :20"
603980381,,".3.1","SQL-som","select sum(q.qrd_value_asset) from qrap_data qwhere q.qrd_opdracht_id = ~1:2"
603980394,,".1.1","ChartData","select  q.qd_regeltype , bi.be_oms_1 "oms", q.qd_saldo_positie "aantal", bi.be_aantal_cijfers_display, q.qd_koers_bi "koers", q.qd_valuta_bi "valuta", q.qd_koers_vv "koers_vv", q.qd_waarde_clv "waarde", q.qd_aankoopkoers_bi "aankoopkoers", q.qd_aankoopwaarde_clv "aankoopwaarde", q.qd_aankoopwaarde_bi "aankoopwaarde_bi", q.qd_resulaat_clv "resultaat", q.unrealised_result_period_perc "res_aankoop", q.unrealised_result_ytd_perc "res_ytd", q.qd_perc_subassetclass  "perc_ass", q.qd_opgelopen_rente_clv "rente", q.qd_effectief_rendement "eff_rend", q.qd_rating "rating", q.qd_duration "duration", q.re_id , q.qd_asset_class "asset", ic1.description "class", ic2.description "nfi", bi.be_bi_nummer "bi-type", decode (q.qd_regeltype, 'T', 9999, ic1.code_nr) sort1, decode (q.qd_regeltype, 'D', ic2.code_nr, 9999) sort2, q.qd_begin_waarde_per_bi, q.qd_begin_waarde_jaar_bi, q.qd_begin_waarde_per_clv, q.qd_begin_waarde_jaar_clv, q.qd_eind_waarde_clv, bi.be_symbool, bi.be_optietype, bi.be_expiratiedatum, bi.be_exerciseprijsfrom qrap_detail_port qleft outer join beleggingsinstrument bi on bi.be_volgnummer = q.qd_instrumentleft outer join instr_classes ic1 on ic1.id = q.qd_classificatie_1 left outer join instr_classes ic2 on ic2.id = q.qd_classificatie_2where q.qd_opdracht_id = ~1 :2:3"
603980429,,".3","Doe Modelportefeuille","select s.sac_ac_id assetclass, s.sac_id subassetclass, icl.id, rd.rvd_huidige_waarde_rek_val*m.inas_percentage/100  waarde, rd.rvd_gewenst_ideaal_percentage*m.inas_percentage   ideaalfrom revisie_detail rdinner join beleggingsinstrument bi on rd.rvd_fondssymbool = bi.be_symbooland rd.rvd_optietype = bi.be_optietypeand rd.rvd_expiratiedatum = bi.be_expiratiedatumand rd.rvd_exerciseprijs = bi.be_exerciseprijsinner join instrument_assetmix m on m.inas_be_id = bi.be_volgnummerinner join subassetclass s on s.sac_id = m.inas_sac_idleft outer join instr_class_mix icm on icm.be_id = bi.be_volgnummerleft outer join instr_classes icl on icl.id = icm.icl_idleft outer join instr_class_types ict on ict.id = icl.iclt_idwhere rd.rvd_voorstelnummer = ~1and to_number(substr(rd.rvd_volgorde,1,4)) in (:2)and ict.code = ~3order by assetclass, subassetclass , icl.code_nr;"
603980339,,".1","SQL-GetPortfoliovalue","select sum(report_value), sum(system_value) from (select avg(b.value)*count(*)/~5 report_value, avg(b.value*q.quote)*count(*)/~5 system_value, b.instrument_id from pc_portfolio_base b INNER JOIN pERFORMANCE_REPORT R ON R.ID = B.PERE_IDinner join pc_quote_per_day_vw q on q.be_id = ~4 and quote_date = b.calc_date:6where r.ppr_id = ~1 and b.calc_date between to_date(~2, 'DD-MM-YYYY') and to_date(~3, 'DD-MM-YYYY')group by  b.instrument_id)"
471859982,,".1","Bepaal Datum Geldsaldo SQL","select max(p.:1) datumfrom positiemutaties_geld pwhere p.pmg_re_id = ~2 and:3  <= ~4"
603980392,,".1.1","ChartData","select t.tr_transnummer "Nummer", t.tr_transdatum  "datum", t.tr_indicatie   "Indi" , ltrim(ltrim(trim(o.to_omschrijving1)||' ')||trim(o.to_omschrijving2)||' '||trim(o.to_omschrijving3)) "Oms", t.tr_herkomst_code_tr "Herkomst", t.tr_mutatiecode "Mutatie", b.be_oms_1 "Instrument", b.be_bi_nummer, t.tr_be_muntsoort "Munt", t.tr_aantal "Aantal", b.be_aantal_cijfers_display, b.be_prijs_factor, t.tr_be_munt_krs "Koers", t.tr_prijs_tr_mntsrt "prijs", t.tr_belasting "Bel", t.TR_MUT_KOSTEN_PLUS_BTW + t.TR_PROVISIE+ t.Tr_Transferprov+ t.Tr_Chequekosten+ t.TR_RESTITUTIEPROVISI+ t.TR_REALLOWANCE+ t.TR_SETTLEMENT_KOSTEN+ t.TR_PROVISIEKORTING+ t.TR_BELASTFYSLEV_KB+ t.tr_kostenbet_verk+ t.tr_overige_kosten+ t.TR_DEP_RENTE_INFO "Kosten", t.TR_KOSTEN "kosten_vv", t.tr_notabedrag "Netto", t.tr_volgnummer "Vlgnr", t.tr_rel1, t.tr_rel1_rek1, t.tr_rel1_rek1_soort, t.tr_rel2, t.tr_rel2_rek1, t.tr_rel2_rek1_soort, t.tr_rel2_rek2, t.tr_symbool, t.tr_optietype, t.tr_expiratiedatum, t.tr_exerciseprijs, t.tr_prijs_factor, t.tr_exass_factor, decode (r.re_nummer - t.tr_rel1, 0, t.tr_rel1_rap_munts, t.tr_rel2_rap_munts) rap_munt, decode (r.re_nummer - t.tr_rel1, 0, t.tr_rel1_rap_krs, t.tr_rel2_rap_krs) rap_krs, decode (r.re_nummer - t.tr_rel1, 0, t.tr_rel1_rap_fac, t.tr_rel2_rap_fac) rap_fac, decode (r.re_nummer - t.tr_rel1, 0, t.tr_rel1_rap_rcp, t.tr_rel2_rap_rcp) rap_rcp, t.tr_trans_munts, t.tr_trans_munts_krs, t.tr_trans_munts_fac, t.tr_trans_munts_rcp, decode (r.re_nummer - t.tr_rel1, 0, t.tr_rel1_rek2_munts, t.tr_rel2_rek2_munts) rek_munt, decode (r.re_nummer - t.tr_rel1, 0, t.tr_rel1_munts_krs, t.tr_rel2_munts_krs) rek_krs, decode (r.re_nummer - t.tr_rel1, 0, t.tr_rel1_munts_fac, t.tr_rel2_munts_fac) rek_fac, decode (r.re_nummer - t.tr_rel1, 0, t.tr_rel1_munts_rcp, t.tr_rel2_munts_rcp) rek_rcp, t.tr_mut_gemaakt , t.tr_ref_symbool , t.tr_rente , decode (r.re_nummer - t.tr_rel1, 0, 101, 102) ic_code, decode (c.quote, NULL, 0, c.quote) quote, ts.ts_koop_verkoop_ind, t.tr_context_enum :1from transakties t left outer join transactioncurrencyquotes c on c.tr_volgnummer=t.tr_volgnummer and c.class = 50 left outer join trans_omschrijving o on o.to_transactievolgnr = t.tr_volgnummerinner join beleggingsinstrument b on b.be_symbool = t.tr_symbooland b.be_optietype = t.tr_optietypeand b.be_expiratiedatum = t.tr_expiratiedatumand b.be_exerciseprijs = t.tr_exerciseprijsinner join transactiesoorten ts on ts.ts_symbool=t.tr_indicatieinner join qrap_header q on q.id = ~2 inner join rekeningen r on r.re_id = q.security_re_idwhere t.tr_volgnummerin( select ti.trai_tr_volgnummer from tap_tr_rel_account_info ti inner join transactions t2 on t2.tr_volgnummer = ti.trai_tr_volgnummerinner join rekeningen r2 on r2.re_id = ti.trai_tr_re_id inner join rekeningen_per_product rp on  rp.rpp_relatienummer = r2.re_nummer and  rp.rpp_rekening_nummer = r2.re_rekening and  rp.rpp_rekeningsoort = r2.re_soort and  rp.rpp_valuta = r2.re_muntsoortinner join producten_per_relatie pr on  pr.ppr_relatienummer = r2.re_nummer and  pr.ppr_productnummer = rp.rpp_productnummer and  pr.ppr_volgnr_per_product = rp.rpp_volgnr_per_product and pr.ppr_id = ~4 inner join transactiesoorten ts2 on ts2.ts_symbool=t2.tr_indicatie inner join beleggingsinstrument b2 on b2.be_symbool = t2.tr_symbooland b2.be_optietype = t2.tr_optietypeand b2.be_expiratiedatum = t2.tr_expiratiedatumand b2.be_exerciseprijs = t2.tr_exerciseprijs:3   where ti.trai_tr_account_code in (1,2,3,4)and ((t2.tr_mut_gemaakt='J' and t2.tr_transdatum between ~5 and ~6)or (t2.tr_mut_gemaakt in ('s','S') and t2.tr_boekdatum between ~5 and ~6 and t2.tr_transdatum < ~5)) :7)order by sortering, t.tr_indicatie, t.tr_transdatum, t.tr_transnummer"
939524839,,".4","createMutPerSecuPerAcc_Sql","select FULL_QUERY.*,rownum "ROW_NUM" from (   select pom.pom_peildatum "TRANS_DATE",          pom.pom_transactienr "TRANS_NUMBER",          pom.pom_mutatie_aantal "POM_MUTATIE_AANTAL",          pom.pom_mutatie_prijscl "POM_MUTATIE_PRIJSCL",          pom.pom_mutatie_prijsbe "POM_MUTATIE_PRIJSBE",          pom.pom_saldo_positie "POM_SALDO_POSITIE",          (pom.pom_peildatum||';'||to_char(pom.pom_transactienr,'fm099999999'))"SORT_DATE_TRANSNR",          be.be_volgnummer "BE_VOLGNUMMER",          be.be_oms_1 "BE_OMS1",          be.be_muntsoort "BE_MUNTSOORT",          be.be_prijs_factor "BE_PRIJS_FACTOR",          be.be_aantal_cijfers_display "BE_AANTAL_CIJFERS_DISPLAY",          tr.tr_volgnummer "TR_VOLGNUMMER",          tr.tr_indicatie "TR_INDICATIE",          tr.tr_boekdatum "TR_BOEKDATUM",          m.code  "MC_MUTATIECODE",          m.external_code "MC_EXTERNAL_CODE",          m.description "MC_DESCRIPTION"   from posmuttransdatum pom         inner join beleggingsinstrument be on be.be_volgnummer=pom.pom_be_volgnummer        inner join transactions tr on tr.tr_volgnummer=pom.pom_tr_volgnummer        left outer join mutationcodes m on m.code = tr.tr_mutatiecode      where         :1      order by         pom_peildatum DESC,        pom_transactienr DESC ) FULL_QUERYwhere   :2"