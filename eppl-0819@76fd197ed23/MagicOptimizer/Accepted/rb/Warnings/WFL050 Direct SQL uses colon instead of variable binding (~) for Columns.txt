Program ISN,Program #,Task,Name,SQL
353,,".2","Legen tijdelijke selectie","delete :1 where tst_functienaam = ':2' and tst_datum = ':3' and tst_volgnummer = :4"
406,,".3.1","SQL taak","select B.RELATIENR from( select rownum "RIJ", A.RELATIENR from(  select w.cw_relatienummer "RELATIENR"  from :1 w  where w.cw_relatienummer between ~2 and ~3  and w.cw_clientgroep_oud between ~4 and ~5  and w.cw_clientgroep_nieuw between ~6 and ~7  and w.cw_productnummer_oud between ~8 and ~9  and w.cw_productvolgnr_oud between ~10 and ~11  and w.cw_productnummer_nieuw between ~12 and ~13  and w.cw_status = 5  order by w.cw_relatienummer asc)A )Bwhere MOD(B.RIJ, :14)=0"
493,,".8","Doorloop producten (temp/SQL)","with prod_old as (select coalesce(to_number(regexp_substr(wk.wk_categorie_1, '^\d+(\.\d+)?')),                  0) as ppr_id,         coalesce(to_number(regexp_substr(wk.wk_categorie_2, '^\d+(\.\d+)?')),                  0) as ppr_relatienummer,         coalesce(to_number(regexp_substr(wk.wk_categorie_3, '^\d+(\.\d+)?')),                  0) as ppr_productnummer,         wk.wk_datum_1 as ppr_einddatum    from :1 wk   where wk.wk_terminal = :3     and wk.wk_soort = 'PROD'     and wk.wk_categorie_2 = ':4'),prod_new as (select ppr.ppr_id,         ppr.ppr_relatienummer,         ppr.ppr_productnummer,         ppr.ppr_einddatum    from :2 ppr   where ppr.ppr_relatienummer = :4)select coalesce(prod_old.ppr_id, prod_new.ppr_id) as ppr_id,       nvl(prod_old.ppr_productnummer, 0) as ppr_productnummer_old,       nvl(prod_new.ppr_productnummer, 0) as ppr_productnummer_new,       nvl(prod_new.ppr_einddatum, 0) as ppr_einddatum  from prod_old  full outer join prod_new    on prod_old.ppr_id = prod_new.ppr_id where prod_old.ppr_id is null    or prod_new.ppr_id is null    or prod_old.ppr_relatienummer <> prod_new.ppr_relatienummer    or prod_old.ppr_productnummer <> prod_new.ppr_productnummer    or prod_old.ppr_einddatum <> prod_new.ppr_einddatum"
631,,".3.3.2","SQL Delete","delete from :1 where :2"
634,,".3","Structuur","Select hpp.hpp_relatienummer, ppr.ppr_enof_type, hr.rhr_code, p.pr_productnaam, hpp.hpp_product, hpp.hpp_product_volgnr, r.re_rekening, r.re_soort, r.re_omschrijving from   :1 hpp, :2 p, :3 rpp, :4 r, :5 hr, :6 ppr where   hpp.hpp_type_holder = hr.rhr_rolnummer and  hpp.hpp_product = p.pr_productnummer and  hpp.hpp_relatienummer = rpp.rpp_relatienummer and  hpp.hpp_product = rpp.rpp_productnummer and  hpp.hpp_product_volgnr = rpp.rpp_volgnr_per_product and  rpp.rpp_relatienummer = r.re_nummer and  rpp.rpp_rekening_nummer = r.re_rekening and  rpp.rpp_rekeningsoort = r.re_soort and  rpp.rpp_valuta = r.re_muntsoort and  ppr.ppr_relatienummer = rpp.rpp_relatienummer and  ppr.ppr_productnummer = rpp.rpp_productnummer and  ppr.ppr_volgnr_per_product = rpp.rpp_volgnr_per_product and   hpp.hpp_holdernummer = :7 order by hpp.hpp_relatienummer"
100664527,,".5","WriteDateVector","select distinct (t.mutation_date) from RISKPROFILE_PER_PRODUCT twhere t.pr_id = :1and t.qult_id = :2and t.mutation_date > sysdateorder by t.mutation_date desc"
402654443,,".1","ProductInvSett doorlopen","select t.ps_ppr_idfrom PRODUCT_INVESTMENT_SETTINGS t, PRODUCTEN_PER_RELATIE pprwhere t.ps_last_revision_profile >= TO_DATE(':1', 'yyyymmdd')  and t.ps_last_revision_profile <= TO_DATE(':2', 'yyyymmdd')  and ppr.ppr_productnummer = :3  and ppr.ppr_id = t.ps_ppr_id"
517997884,,".1","Producten doorlopen","select p.ppr_id, p.ppr_doeldatum from producten_per_relatie p where p.ppr_productnummer = ~1 and p.ppr_doeldatum is not null and p.ppr_doeldatum > to_date(':2', 'YYYYMMDD') and p.ppr_doeldatum <= to_date(':3', 'YYYYMMDD')"
517997884,,".2","Accounts doorlopen","select p.ppr_id, r.re_nummer, r.re_rekening, r.re_soort, r.re_muntsoort, r.re_id, i.target_date from account_extrainfo i inner join rekeningen r on r.re_id = i.re_idinner join rekeningen_per_product rp on rp.rpp_relatienummer=r.re_nummer and rp.rpp_rekening_nummer=r.re_rekening and rp.rpp_rekeningsoort=r.re_soort and rp.rpp_valuta=r.re_muntsoortinner join producten_per_relatie p on p.ppr_relatienummer=rp.rpp_relatienummer and p.ppr_productnummer=rp.rpp_productnummer and p.ppr_volgnr_per_product=rp.rpp_volgnr_per_productwhere rp.rpp_productnummer = ~1 and i.target_date is not null and i.target_date > to_date(':2', 'YYYYMMDD') and i.target_date <= to_date(':3', 'YYYYMMDD')"
905970780,,".1.4","Verwijder economische posities","delete   from AKTUELE_POSITIES where ap_relatienr = :1   and ap_rekening_soort = 0"
1500513534,,".4","OphalenPprId SQL","select ppr.ppr_id, ppr.ppr_relatienummer, ppr.ppr_productnummer, ppr.ppr_volgnr_per_product from producten_per_relatie ppr inner join producten p on p.pr_productnummer=ppr.ppr_productnummerinner join rekeningen_per_product rpp on rpp.rpp_relatienummer=ppr.ppr_relatienummer and rpp.rpp_productnummer=ppr.ppr_productnummer and rpp.rpp_volgnr_per_product=ppr.ppr_volgnr_per_productinner join rekeningen r on r.re_nummer=rpp.rpp_relatienummer and r.re_rekening=rpp.rpp_rekening_nummer and r.re_soort=rpp.rpp_rekeningsoort and r.re_muntsoort=rpp.rpp_valutawhere p.pr_status=1 and ppr.ppr_relatienummer=~1 and (~2=0 or ppr.ppr_productnummer=~2) and (~3=0 or ppr.ppr_volgnr_per_product=~3) and r.re_geblokkeerd in (:4) and r.re_rekening_status<=~5 and (~6=' ' or rpp.rpp_rekening_nummer=~6) fetch first row only"
4195654,,".2","writeResponse","SELECT A.EACC_EXAC_ID,A.EACC_ACCOUNT_NR,       B.EXAC_ASCRIPTION_1,       B.EXAC_ASCRIPTION_2,       B.EXAC_STATE_IND,       B.EXAC_REGISTER_DATE,       B.EXAC_MUTATION_DATE,       A.EACC_BANK_IDENTIFIER  FROM PR_EXT_ACC_CONNECTIONS_VW A, PR_EXTERNAL_ACCOUNTS_VW B WHERE B.EXAC_ID = A.EACC_EXAC_ID   AND A.EACC_ACCOUNT_TYPE = 'IBAN'   AND (A.EACC_EXAC_ID <= :1 OR :4 )   AND A.EACC_ACCOUNT_NR LIKE ('%:2%') ORDER BY A.EACC_EXAC_ID DESC  FETCH FIRST :3 ROWS ONLY"