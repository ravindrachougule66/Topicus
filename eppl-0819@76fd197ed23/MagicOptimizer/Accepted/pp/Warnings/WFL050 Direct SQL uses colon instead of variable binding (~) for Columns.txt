Program ISN,Program #,Task,Name,SQL
190,,".3.1","SQL taak","select   D.RELATIENRfrom   (      select         rownum "RIJ"       , C.RELATIENR      from         (            select   distinct               r.re_nummer "RELATIENR"            from               rekeningen r               inner join                  clienten c                  on                     c.cl_nummer          =r.re_nummer                     and c.cl_relatie_type=1               inner join                  clientgroepen g                  on                     g.cg_code            =c.cl_clientgroep                     and g.cg_renseigneren>0               inner join                  rekening_soorten s                  on                     s.rs_soort           =r.re_soort                     and s.rs_renseigneren>0            where               (                  :1               = 0                  OR r.re_nummer >= :1               )               AND               (                  :2       = 999999999                  OR r.re_nummer <= :2               )               and r.re_soort between 1 and 2999			   and r.re_status between 1 and 8            order by               r.re_nummer         )         C   )   Dwhere   mod (D.RIJ,:3)=0"
214,,".4.1","SQL taak","select min(transactienummer), max(transactienummer)  from (select NTILE(:1) over(order by transactienummer asc) groep, transactienummer       from (select relatie, transactienummer            from (select t.wvwt_tr_rel1 relatie, t.wvwt_tr_transnummer transactienummer                  from  :3 t               union all               select t2.wvwt_tr_rel2 relatie, t2.wvwt_tr_transnummer transactienummer                 from :3 t2)           inner join  :2 c              on c.cl_nummer = relatie             and c.cl_relatie_type = 1           where c.cl_nummer between :4 and :5)      order by relatie) group by groep order by groep"
214,,".4.2","SQL taak (Aktuele Posities)","select max(relatie) from (select NTILE(:1) over(order by relatie asc) groep, relatie        from (select relatie                from (select a.ap_relatienr relatie                        from :2 a)               inner join :3 c                  on c.cl_nummer = relatie                 and c.cl_relatie_type = 1               where c.cl_nummer between ~4 and ~5)               order by relatie)       group by groep order by groep"
214,,".5.1","Vul TransactieWerkbestand","insert into :1 A select  :4T.TR_TRANSNUMMER,T.TR_REL1,T.TR_REL1_REK2,T.TR_REL1_REK2_SOORT,T.TR_REL1_REK2_MUNTS,T.TR_REL1_MUNTS_KRS,T.TR_REL1_MUNTS_FAC,T.TR_REL1_MUNTS_RCP,T.TR_REL1_RAP_MUNTS,T.TR_REL1_RAP_KRS,T.TR_REL1_RAP_FAC,T.TR_REL1_RAP_RCP,T.TR_REL2,T.TR_REL2_REK2,T.TR_REL2_REK2_SOORT,T.TR_REL2_REK2_MUNTS,T.TR_REL2_MUNTS_KRS,T.TR_REL2_MUNTS_FAC,T.TR_REL2_MUNTS_RCP,T.TR_REL2_RAP_MUNTS,T.TR_REL2_RAP_KRS,T.TR_REL2_RAP_FAC,T.TR_REL2_RAP_RCP,T.TR_SYMBOOL,T.TR_OPTIETYPE,T.TR_EXPIRATIEDATUM,T.TR_EXERCISEPRIJS,T.TR_BE_MUNTSOORT,T.TR_BE_MUNT_KRS,T.TR_BE_MUNT_FAC,T.TR_BE_MUNT_RCP,T.TR_TRANS_MUNTS,T.TR_TRANS_MUNTS_KRS,T.TR_TRANS_MUNTS_FAC,T.TR_TRANS_MUNTS_RCP,T.TR_PRIJS_TR_MNTSRT,T.TR_PRIJS_FACTOR,T.TR_INDICATIE,T.TR_HERKOMST_CODE_TR,T.TR_MUTATIECODE,T.TR_TRANSDATUM,T.TR_AANTAL,T.TR_RENTE,nvl((select sum(c.tcc_amount_syst_currency) from trans_calc_components_vw c where c.tcc_tr_id = T.TR_VOLGNUMMER and c.tcc_calculation_type = 'TAX'),0),T.TR_BATCHCODE,T.TR_BATCHREGEL,T.TR_REF_TRANSNUMMER,T.TR_DIVIDENDCODE,T.TR_VRUCHTRELATIE,T.TR_VRUCHTREL_RAP_MUNTS,T.TR_VRUCHTREL_RAP_KRS,T.TR_VRUCHTREL_RAP_FAC,T.TR_VRUCHTREL_RAP_RCP,T.TR_VRUCHTREK_NR,T.TR_VRUCHTREK_SOORT,T.TR_VRUCHTREK_MUNTSRT,T.TR_VRUCHTREK_MNT_KRS,T.TR_VRUCHTREK_MNT_FAC,T.TR_VRUCHTREK_MNT_RCP, decode(T.TR_MUT_GEMAAKT, 's', T.TR_ORIGTR_STORNO,0),T.TR_NOTABEDRAG,T.TR_EXASS_FACTOR  from :2 T where :3"
246,,".2","CountCyclesToDo (SQL)","SELECT count(*)  FROM aktuele_posities A, beleggingsinstrument  B, koerskodes C, clienten D WHERE  (A.AP_SYMBOOL BETWEEN  ~1   and  ~2)  AND C.KC_LEVERANCIER =  ~3    AND  (D.CL_RELATIE_TYPE =  1 and A.AP_REKENING_SOORT BETWEEN  100  and  999  OR   A.AP_REKENING_SOORT BETWEEN  1  and  99)     AND (A.AP_BI_TYPE between 100 and 299 or A.AP_BI_TYPE between 500 and 699  :4) AND (B.BE_SYMBOOL=A.AP_SYMBOOL AND B.BE_OPTIETYPE=A.AP_OPTIETYPE AND B.BE_EXPIRATIEDATUM=A.AP_EXPIRATIEDATUM AND B.BE_EXERCISEPRIJS=A.AP_EXERCISEPRIJS AND C.KC_SYMBOOL=A.AP_SYMBOOL AND C.KC_OPTIETYPE=A.AP_OPTIETYPE AND C.KC_EXPIRATIEDATUM=A.AP_EXPIRATIEDATUM AND C.KC_EXERCISEPRIJS=A.AP_EXERCISEPRIJS AND D.CL_NUMMER=A.AP_RELATIENR)"
249,,".3","Count CyclesToDo","SELECT  count(*)FROM transakties A, beleggingsinstrument BWHERE A.TR_SYMBOOL between ~1 and ~2    AND  (A.TR_BOEKDATUM BETWEEN  ~3   and  ~4  )  AND (not exists (select 1 from tv_transactions_in_progress C where C.trip_tr_volgnummer = A.tr_volgnummer) and (A.TR_TRANSDATUM> ~5   or A.TR_BOEKDATUM>  ~6  ) and (B.BE_BI_NUMMER between 100 and 699 or B.BE_BI_NUMMER=751 or B.BE_BI_NUMMER between 2000 and 2149 or B.BE_BI_NUMMER=2200) :7) AND (B.BE_SYMBOOL=A.TR_SYMBOOL AND B.BE_OPTIETYPE=A.TR_OPTIETYPE AND B.BE_EXPIRATIEDATUM=A.TR_EXPIRATIEDATUM AND B.BE_EXERCISEPRIJS=A.TR_EXERCISEPRIJS )"
1398800797,,".10","6. Product verhuisd naar box 3","select   a.ppr_id , b.ppr_verhuisreg_datum , c.hpp_holdernummer , d.pr_fiscaal_domein , f.re_id , f.re_datum_beeindigdfrom   pr_products_per_client_vw a   inner join      producten_per_relatie b      on         b.ppr_relatienummer         =a.ppr_relatienummer         and b.ppr_productnummer     =a.ppr_productnummer         and b.ppr_volgnr_per_product=a.ppr_volgnr_per_product   inner join      holders_per_product c      on         c.hpp_relatienummer     =a.ppr_relatienummer         and c.hpp_product       =a.ppr_productnummer         and c.hpp_product_volgnr=a.ppr_volgnr_per_product         and c.hpp_type_holder   =1         and c.hpp_holdernummer >= :1         and c.hpp_holdernummer <= :2   inner join      producten d      on         d.pr_productnummer= a.ppr_productnummer   inner join      rekeningen_per_product e      on         e.rpp_productnummer         =a.ppr_productnummer         and e.rpp_volgnr_per_product=a.ppr_volgnr_per_product         and e.rpp_relatienummer     =a.ppr_relatienummer         and e.rpp_rekeningsoort between 1000 and 1199   inner join      rekeningen f      on         f.re_nummer              =a.ppr_relatienummer         and f.re_rekening        =e.rpp_rekening_nummer         and f.re_soort           =e.rpp_rekeningsoort         and f.re_muntsoort       =e.rpp_valuta         and f.re_default_rekening=1where   a.ppr_productnummer between :3 and :4   :5   and a.ppr_status<9   and b.ppr_verhuisregeling=1   and trunc(b.ppr_verhuisreg_datum) between to_date(:6,'YYYYMMDD') and to_date(:7,'YYYYMMDD')"
1398800797,,".11","7. Product gedeblokkeerd","select   a.ppr_id , j.expiration_date , c.hpp_holdernummer , d.pr_fiscaal_domein , f.re_id , f.re_datum_beeindigdfrom   pr_products_per_client_vw a   inner join      producten_per_relatie b      on         b.ppr_relatienummer         =a.ppr_relatienummer         and b.ppr_productnummer     =a.ppr_productnummer         and b.ppr_volgnr_per_product=a.ppr_volgnr_per_product   inner join      holders_per_product c      on         c.hpp_relatienummer     =a.ppr_relatienummer         and c.hpp_product       =a.ppr_productnummer         and c.hpp_product_volgnr=a.ppr_volgnr_per_product         and c.hpp_type_holder   =1         and c.hpp_holdernummer >= :1         and c.hpp_holdernummer <= :2   inner join      producten d      on         d.pr_productnummer= a.ppr_productnummer   inner join      rekeningen_per_product e      on         e.rpp_productnummer         =a.ppr_productnummer         and e.rpp_volgnr_per_product=a.ppr_volgnr_per_product         and e.rpp_relatienummer     =a.ppr_relatienummer         and e.rpp_rekeningsoort between 1000 and 1199   inner join      rekeningen f      on         f.re_nummer              =a.ppr_relatienummer         and f.re_rekening        =e.rpp_rekening_nummer         and f.re_soort           =e.rpp_rekeningsoort         and f.re_muntsoort       =e.rpp_valuta         and f.re_default_rekening=1   inner join      clienten g      on         g.cl_nummer=a.ppr_relatienummer   inner join      contract_base h      on         h.coba_cl_id=g.cl_id   inner join      blocked_contract j      on         j.blco_coba_id=h.idwhere   a.ppr_productnummer between :3 and :4   :5   and trunc(j.expiration_date) between to_date(:6,'YYYYMMDD') and to_date(:7,'YYYYMMDD')"
1398800797,,".12","8 BEW/SEW niet beeindigd","select distinct ha.hyp_hypotheeknummer, bh.bew_overdr_jr_hoog, bh.bew_overdr_jr_laag , ha.hyp_passeerdatumfrom hypotheekaanvragen hainner join rekeningen_per_product rpp on rpp.rpp_relatienummer = ha.hyp_relatienr_ep and rpp.rpp_rekening_nummer = to_char(ha.hyp_rekeningnr_ep)inner join rekeningen r on r.re_nummer = ha.hyp_relatienr_ep and r.re_rekening = rpp.rpp_rekening_nummerinner join producten p on p.pr_productnummer = rpp.rpp_productnummer inner join holders_per_product hpp on  hpp.hpp_relatienummer =rpp.rpp_relatienummer and hpp.hpp_product=rpp.rpp_productnummer and hpp.hpp_product_volgnr=rpp.rpp_volgnr_per_productleft outer join bew_stortingen_header  bh on rpp.rpp_relatienummer = bew_relatienummerand bew_rekeningnummer = rpp.rpp_rekening_nummer and bew_rekeningsoort = rpp.rpp_rekeningsoort and bew_rekeningvaluta = rpp.rpp_valutawhere p.pr_productnummer between ~1 and ~2and hpp.hpp_holdernummer between ~3 and ~4and p.pr_product_kenmerk in ('BEW'  ,'SEW') and ha.hyp_passeerdatum is not nulland substr(nvl(ha.hyp_passeerdatum,'00000000'),5,2)=  ~5and re_default_rekening=1and hpp.hpp_type_holder in (1, 2)and not exists( select 1 from mf_termination_dtl f where f.tndt_re_id=r.re_id) :6"
1398800797,,".6","2 Toekennen erfdeel","select   b.ppr_id , c.hpp_holdernummer , a.erf_relnr_erfgenaam , a.erf_productnummer , a.erf_volgnr_per_product , a.erf_holdernr_erfgenaam , a.erf_mutatie_volgnummer , d.mub_autorisatiedatumfrom   producten_per_relatie b , holders_per_product   c , erven_per_product     a , mutatie_bestand       d , producten        ewhere   b.ppr_productnummer    >=:1   and b.ppr_productnummer    <=:2   :3   and c.hpp_relatienummer     =b.ppr_relatienummer   and c.hpp_product           =b.ppr_productnummer   and c.hpp_product_volgnr    =b.ppr_volgnr_per_product   and c.hpp_type_holder       =1   and c.hpp_holdernummer     >= :4   and c.hpp_holdernummer     <= :5   and e.pr_productnummer   = b.ppr_productnummer   and e.pr_product_kenmerk in ('BEW'  ,'SEW')   and a.erf_relatienummer     =b.ppr_relatienummer   and a.erf_productnummer     =b.ppr_productnummer   and a.erf_volgnr_per_product=b.ppr_volgnr_per_product   and d.mub_mutatie_volgnummer=a.erf_mutatie_volgnummer   and d.mub_autorisatiedatum between ':6' and ':7'   and d.mub_type_mutatie in (11,12)order by b.ppr_id, d.mub_autorisatiedatum"
1398800797,,".7","3 Uitgaande overdracht","select   a.her_av_id , a.her_landcode , b.av_ep_relnummer , d.fp_product , d.fp_product_volgnr , c.stv_datumfrom   kw_herkomst           a , kw_aanvraag           b , kw_statusverloop      c , kw_financieel_product dwhere   a.her_herkomst_type          =5   and a.her_landcode >0   and b.av_id                  =a.her_av_id   and b.av_huidige_status      =900   and c.stv_aanvraag_id        =a.her_av_id   and c.stv_status_id          =900   and c.stv_datum between ':1' and ':2'   and d.fp_aanvraag_id    =a.her_av_id   and d.fp_aanvraagtype_id=b.av_aanvraagtype_id   and d.fp_product    >=:3   and d.fp_product<=:4:5   "
1398800797,,".8","4 Scheiding","select   b.hpp_holdernummer , a.mub_autorisatiedatum , a.mub_mutatie_volgnummer , e.re_id , e.re_datum_beeindigd , f.ppr_id , c.pr_fiscaal_domeinfrom   mutatie_bestand        a , holders_per_product    b , producten              c , rekeningen_per_product d , rekeningen             e , producten_per_relatie  f , mutaties_bs_holder gwhere   a.mub_autorisatiedatum between ':1' and ':2'   and a.mub_type_mutatie in (14 , 15)   and a.mub_product >= :3   and a.mub_product <= :4   :5   and g.mbh_mutatie_volgnummer=a.mub_mutatie_volgnummer   and b.hpp_relatienummer     =a.mub_relatie_nr   and b.hpp_product           =a.mub_product   and b.hpp_product_volgnr    =a.mub_product_volgnr   and b.hpp_type_holder       =1   and b.hpp_holdernummer     >= :6   and b.hpp_holdernummer     <= :7   and c.pr_productnummer      =a.mub_product   and d.rpp_productnummer     =a.mub_product   and d.rpp_volgnr_per_product=a.mub_product_volgnr   and d.rpp_relatienummer     =a.mub_relatie_nr   and d.rpp_rekeningsoort between 1000 and 1199   and e.re_nummer             =a.mub_relatie_nr   and e.re_rekening           =d.rpp_rekening_nummer   and e.re_soort              =d.rpp_rekeningsoort   and e.re_muntsoort          =d.rpp_valuta   and e.re_default_rekening   =1   and f.ppr_productnummer     =a.mub_product   and f.ppr_volgnr_per_product=a.mub_product_volgnr   and f.ppr_relatienummer     =a.mub_relatie_nr"
1398800797,,".9","5. Product opgeheven","select   a.ppr_id , b.ppr_einddatum , c.hpp_holdernummer , d.pr_fiscaal_domein , f.re_id , f.re_datum_beeindigdfrom   pr_products_per_client_vw a   inner join      producten_per_relatie b      on         b.ppr_relatienummer         =a.ppr_relatienummer         and b.ppr_productnummer     =a.ppr_productnummer         and b.ppr_volgnr_per_product=a.ppr_volgnr_per_product   inner join      holders_per_product c      on         c.hpp_relatienummer     =a.ppr_relatienummer         and c.hpp_product       =a.ppr_productnummer         and c.hpp_product_volgnr=a.ppr_volgnr_per_product         and c.hpp_type_holder   =1         and c.hpp_holdernummer >= :1         and c.hpp_holdernummer <= :2   inner join      producten d      on         d.pr_productnummer= a.ppr_productnummer   inner join      rekeningen_per_product e      on         e.rpp_productnummer         =a.ppr_productnummer         and e.rpp_volgnr_per_product=a.ppr_volgnr_per_product         and e.rpp_relatienummer     =a.ppr_relatienummer         and e.rpp_rekeningsoort between 1000 and 1199   inner join      rekeningen f      on         f.re_nummer              =a.ppr_relatienummer         and f.re_rekening        =e.rpp_rekening_nummer         and f.re_soort           =e.rpp_rekeningsoort         and f.re_muntsoort       =e.rpp_valuta         and f.re_default_rekening=1    left outer join           hypotheekaanvragen g          on          g.hyp_relatienr_ep=f.re_nummer          and g.hyp_rekeningnr_ep=f.re_rekening   inner join       mutatie_bestand h      on    h.mub_relatie_nr = f.re_nummer   and h.mub_rekening_nummer = f.re_rekening   and h.mub_rekening_soort = f.re_soort   and h.mub_rekening_muntsoort = f.re_muntsoort   where   a.ppr_productnummer between :3 and :4:5   and a.ppr_status=9   and b.ppr_einddatum between ':6' and ':7'   and h.mub_autorisatiedatum between ':6' and ':7'   and h.mub_type_mutatie in (1,16)"
1398800797,,".5","1 BEW/SEW beeindigd","select   distinct   d.hyp_hypotheeknummerfrom   producten              a , rekeningen_per_product b , rekeningen             c , hypotheekaanvragen     d , holders_per_product    e , mf_termination_dtl     fwhere   b.rpp_productnummer     >= :1   and b.rpp_productnummer <= :2   :3   and a.pr_productnummer   = b.rpp_productnummer   and a.pr_product_kenmerk in ('BEW'                              ,'SEW')   and c.re_nummer          =b.rpp_relatienummer   and c.re_rekening        =b.rpp_rekening_nummer   and c.re_soort           =b.rpp_rekeningsoort   and c.re_muntsoort       =b.rpp_valuta   and c.re_default_rekening=1   and trunc(c.re_datum_beeindigd) between to_date(:4,'YYYYMMDD') and to_date(:5,'YYYYMMDD')   and d.hyp_relatienr_ep  =b.rpp_relatienummer   and d.hyp_rekeningnr_ep =b.rpp_rekening_nummer   and e.hpp_relatienummer =b.rpp_relatienummer   and d.hyp_passeerdatum is not null   and e.hpp_product       =b.rpp_productnummer   and e.hpp_product_volgnr=b.rpp_volgnr_per_product   and e.hpp_type_holder in (1                           , 2)   and e.hpp_holdernummer>= :6   and e.hpp_holdernummer<= :7   and f.tndt_re_id=c.re_id   and f.tndt_tnst_tnss_id_last=990"